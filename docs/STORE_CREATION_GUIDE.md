# دليل إنشاء المتاجر الجديدة تلقائياً

## نظرة عامة
تم تطوير نظام **أوتوماتيكي كامل** لإنشاء المتاجر الجديدة بحيث يتم:
1. إضافة المنتجات والصور والأسعار أثناء عملية الإنشاء
2. إضافة صور السلايدرز التي تعرض كل 5 ثوان
3. إنشاء ملفات المتجر تلقائياً في المشروع (config.ts, products.ts, Slider.tsx)

---

## البنية الجديدة للمتاجر

### مسار المتاجر
جميع المتاجر توجد في المسار:
```
src/data/stores/[store-slug]/
├── config.ts       (إعدادات المتجر)
├── products.ts     (بيانات المنتجات)
└── Slider.tsx      (مكون السلايدر)
```

### مثال: متجر "انديش" (Indeesh)
```
src/data/stores/indeesh/
├── config.ts
├── products.ts
└── Slider.tsx
```

---

## خطوات إنشاء متجر جديد

### 1. **الخطوة 1: معلومات المتجر الأساسية**
- اسم المتجر بالعربية
- اسم المتجر بالإنجليزية
- وصف المتجر
- فئات المتجر
- السجل التجاري ورخصة المزاولة
- عنوان المتجر (subdomain)

### 2. **الخطوة 2: بيانات صاحب المتجر**
- الاسم الكامل
- البريد الإلكتروني
- رقم الهاتف

### 3. **الخطوة 3: إعدادات الحساب**
- كلمة المرور
- تأكيد كلمة المرور

### 4. **الخطوة 4: مراجعة البيانات**
- التحقق من صحة جميع البيانات

### 5. **الخطوة 5: إضافة المنتجات** ⭐
أضف منتج واحد أو أكثر مع:
- اسم المنتج
- السعر الحالي
- السعر قبل التخفيض
- الوصف
- يمكن إضافة: الألوان، الأحجام، الصور

### 6. **الخطوة 6: إضافة صور السلايدرز** ⭐
أضف صورة واحدة أو أكثر مع:
- رابط الصورة
- العنوان
- الوصف الفرعي
- نص الزر

---

## العملية الأوتوماتيكية عند الإنشاء النهائي

عند النقر على زر "إنشاء المتجر"، يتم تنفيذ العمليات التالية **تلقائياً**:

### 1. **استدعاء API في الـ Backend**
```
POST /api/stores/create-with-files
```

البيانات المرسلة:
```json
{
  "storeId": 1731761012345,
  "storeSlug": "indeesh",
  "storeName": "انديش",
  "storeNameEn": "Indeesh",
  "description": "متجر انديش للأزياء الفاخرة",
  "icon": "✨",
  "color": "from-purple-400 to-pink-600",
  "categories": ["فساتين", "إكسسوارات", "حقائب"],
  "products": [
    {
      "id": 1,
      "name": "فستان أسود",
      "price": 450,
      "originalPrice": 580,
      ...
    }
  ],
  "sliderImages": [
    {
      "id": "banner1",
      "image": "/assets/slider/image1.jpg",
      "title": "فساتين جديدة",
      ...
    }
  ]
}
```

### 2. **إنشاء الملفات في الـ Frontend**
يقوم الـ Backend بإنشاء:
- `src/data/stores/indeesh/config.ts`
- `src/data/stores/indeesh/products.ts`
- `src/data/stores/indeesh/Slider.tsx`

### 3. **حفظ البيانات في localStorage**
للعمل مع الـ Frontend حتى مع الـ API:
- `eshro_stores`: بيانات المتجر
- `merchant_indeesh`: بيانات التاجر
- `store_products_indeesh`: المنتجات

---

## ملفات التكامل الجديدة

### Backend
#### 1. **StoreGeneratorService** (`backend/src/services/storeGeneratorService.ts`)
مسؤول عن إنشاء الملفات التلقائية:
- تحويل البيانات JSON إلى ملفات TypeScript
- تنسيق الكود بشكل صحيح
- إنشاء مجلد المتجر

#### 2. **StoreController** (`backend/src/controllers/storeController.ts`)
معالج طلبات إنشاء المتاجر:
- `POST /api/stores/create-with-files`: إنشاء متجر كامل
- `POST /api/stores/validate`: التحقق من بيانات المتجر

#### 3. **StoreRoutes** (`backend/src/routes/storeRoutes.ts`)
تعريف مسارات API الجديدة

### Frontend
#### **CreateStorePage** المحدثة (`src/pages/CreateStorePage.tsx`)
- إضافة خطوات 5 و 6 للمنتجات والسلايدرز
- واجهات لإدخال البيانات
- استدعاء API الجديد

---

## مثال عملي: إنشاء متجر "انديش"

### الخطوة 1-4: الإدخال الأساسي
```
- الاسم: انديش
- الوصف: متجر انديش للأزياء الفاخرة
- الفئات: فساتين، إكسسوارات، حقائب
- Subdomain: indeesh
```

### الخطوة 5: إضافة المنتجات
```
منتج 1:
- الاسم: فستان أسود فاخر
- السعر: 450 د.ل
- السعر الأصلي: 580 د.ل
- الوصف: فستان راقي بتصميم عصري

منتج 2:
- الاسم: حقيبة جلدية
- السعر: 280 د.ل
- السعر الأصلي: 360 د.ل
```

### الخطوة 6: إضافة السلايدرز
```
صورة 1:
- الرابط: /assets/indeesh/slider1.jpg
- العنوان: فساتين انديش الفاخرة
- الوصف: اكتشفي مجموعتنا الجديدة
- نص الزر: تسوقي الآن

صورة 2:
- الرابط: /assets/indeesh/slider2.jpg
- العنوان: حقائب أنيقة
- ...
```

### النتيجة النهائية
تم إنشاء المجلد التالي تلقائياً:
```
src/data/stores/indeesh/
├── config.ts
│   export const indeeshStoreConfig = { storeId: 8, ... }
├── products.ts
│   export const indeeshProducts: Product[] = [ ... ]
└── Slider.tsx
    export default IndeeshSlider
```

---

## الفوائد

✅ **تنظيم احترافي**: كل متجر بملفاته الخاصة  
✅ **سهولة الإدارة**: تعديل أي متجر بسهولة  
✅ **توافق البيانات**: نفس التنسيق لجميع المتاجر  
✅ **أوتوماتيكي بالكامل**: لا حاجة للتدخل اليدوي  
✅ **سهل التوسع**: إضافة متاجر جديدة دون تعديل الكود الأساسي  

---

## ملاحظات تقنية

### متطلبات API
- الـ Backend يجب أن يعمل على `http://localhost:3000`
- أو يمكن تحديث URL في `CreateStorePage.tsx` حسب البيئة

### الملفات المنشأة تلقائياً
تتبع نفس النمط الموجود في المتاجر الحالية:
- **config.ts**: بيانات أساسية عن المتجر
- **products.ts**: قائمة كاملة بالمنتجات
- **Slider.tsx**: مكون React لعرض السلايدر

### التوافق مع StoresCarousel
بعد إنشاء المتجر، يظهر تلقائياً في:
- `StoresCarousel`: الصفحة الرئيسية
- `EnhancedMerchantDashboard`: لوحة التاجر
- أي صفحة تعرض قائمة المتاجر

---

## استكمال المرحلة التالية

للمرحلة القادمة يمكن إضافة:
- رفع الصور مباشرة من الواجهة
- دعم المزيد من خصائص المنتجات
- تكامل مع قاعدة البيانات MySQL
- نسخ احتياطية للبيانات

---

**تاريخ التطوير**: نوفمبر 2025  
**الإصدار**: 1.0.0
